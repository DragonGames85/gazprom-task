# Employee Management System

Система управления сотрудниками компании.

## Технологии

- **Backend**: NestJS (Node.js)
- **Frontend**: Next.js 14 (React)
- **База данных**: PostgreSQL
- **Стилизация**: Tailwind CSS

## Функциональность

### Управление подразделениями
- Создание, просмотр, редактирование и ликвидация структурных подразделений
- Иерархическая структура (родительские и дочерние подразделения)
- Поля: код (4 символа), полное наименование, аббревиатура, даты создания и ликвидации

### Управление сотрудниками
- Просмотр, добавление и редактирование информации о сотрудниках
- Поля: табельный номер, ФИО, пол, дата рождения, даты приема/увольнения, подразделение, должность, телефон, email, фотография
- Автоматический расчет возраста и стажа работы
- Отображение силуэта М/Ж при отсутствии фотографии
- Прием, перевод и увольнение сотрудников

### Отчеты
- Формирование списочного отчета по принятым/переведенным/уволенным сотрудникам за указанный период

## Установка и запуск

### Требования
- Node.js 18+
- PostgreSQL 12+
- npm или yarn

### Шаг 1: Клонирование и установка зависимостей

```bash
# Установка зависимостей для всех проектов
npm run install:all
```

### Шаг 2: Настройка базы данных

УБЕДИТЕСЬ, ЧТО У ВАС УСТАНОВЛЕН PostgreSQL!
https://www.postgresql.org/download/

1. Создайте базу данных PostgreSQL:
```sql
CREATE DATABASE gazprom_db;
```

2. Настройте переменные окружения для backend:
```bash
# Перейдите в папку backend и добавьте файл ".env"
cd backend
cp .env
```

Отредактируйте `backend/.env`:
```
DB_HOST=localhost
DB_PORT=5432
DB_USERNAME=ВАШ_ПОЛЬЗОВАТЕЛЬ
DB_PASSWORD=ВАШ_ПАРОЛЬ
DB_NAME=gazprom_db
```

### Шаг 3: Запуск приложения

Откройте два терминала:

**Терминал 1 - Backend:**
```bash
cd backend
npm run start:dev
```
Backend будет доступен на http://localhost:3001

**Терминал 2 - Frontend:**
```bash
cd frontend
npm run dev
```
Frontend будет доступен на http://localhost:3000

### Шаг 4: Использование

1. Откройте браузер и перейдите на http://localhost:3000
2. На главной странице выберите нужный раздел:
   - **Подразделения** - управление структурными подразделениями
   - **Сотрудники** - управление сотрудниками
   - **Отчеты** - формирование отчетов

## Структура проекта

```
gazprom/
├── backend/              # NestJS приложение
│   ├── src/
│   │   ├── departments/  # Модуль подразделений
│   │   ├── employees/    # Модуль сотрудников
│   │   ├── reports/      # Модуль отчетов
│   │   └── main.ts       # Точка входа
│   └── package.json
├── frontend/             # Next.js приложение
│   ├── app/              # Страницы и компоненты
│   ├── lib/              # API клиент
│   └── package.json
└── README.md
```

## API Endpoints

### Подразделения
- `GET /departments` - список всех подразделений
- `GET /departments/hierarchy` - иерархическая структура
- `GET /departments/:id` - информация о подразделении
- `POST /departments` - создание подразделения
- `PATCH /departments/:id` - обновление подразделения
- `POST /departments/:id/liquidate` - ликвидация подразделения

### Сотрудники
- `GET /employees` - список всех сотрудников
- `GET /employees/:id` - информация о сотруднике (с возрастом и стажем)
- `POST /employees` - создание сотрудника
- `PATCH /employees/:id` - обновление сотрудника
- `POST /employees/:id/hire` - прием сотрудника
- `POST /employees/:id/transfer` - перевод сотрудника
- `POST /employees/:id/dismiss` - увольнение сотрудника

### Отчеты
- `GET /reports/employee-movements?startDate=...&endDate=...` - отчет по движению сотрудников

## Особенности реализации

- **Иерархия подразделений**: Реализована через связь `parent-child` в базе данных
- **Ликвидация**: Подразделения не удаляются, а помечаются датой ликвидации
- **Статусы сотрудников**: active, transferred, dismissed
- **Расчет возраста и стажа**: Выполняется на бэкенде при запросе информации о сотруднике
